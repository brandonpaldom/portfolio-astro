---
import Layout from "@layouts/Layout.astro";
import BlogCard from "@components/BlogCard.astro";
import { getCollection } from 'astro:content';

// Get all blog posts
const allPosts = await getCollection('blog');

// Sort posts by publication date (newest first)
const sortedPosts = allPosts
  .filter(post => post.data.pubDate)
  .sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime());

// Get unique tags for filtering
const allTags = [...new Set(sortedPosts.flatMap(post => post.data.tags || []))];
---

<Layout
  title="Blog | Brandon Palmeros - Desarrollo Frontend"
  subtitle="Blog"
  description="Artículos sobre desarrollo web frontend, JavaScript, React, Astro, y las últimas tendencias en tecnología web."
>
  <div class="mb-6">
    <p class="text-neutral-300 leading-relaxed">
      Comparto mis experiencias, aprendizajes y reflexiones sobre el desarrollo web frontend, 
      las últimas tecnologías y mejores prácticas en la industria.
    </p>
  </div>

  {allTags.length > 0 && (
    <div class="mb-6">
      <h3 class="heading3 font-semibold text-neutral-100 mb-3">Categorías</h3>
      <div class="flex flex-wrap gap-2">
        {allTags.map((tag) => (
          <span class="chip chip-secondary cursor-pointer hover:bg-indigo-500/20 hover:text-indigo-300 transition-colors">
            {tag}
          </span>
        ))}
      </div>
    </div>
  )}

  {sortedPosts.length > 0 ? (
    <div class="grid gap-6 mt-6">
      {sortedPosts.map((post) => (
        <BlogCard post={post} />
      ))}
    </div>
  ) : (
    <div class="text-center py-12">
      <h3 class="heading3 font-semibold text-neutral-100 mb-2">
        Próximamente...
      </h3>
      <p class="text-neutral-400">
        Estoy trabajando en contenido interesante para compartir contigo.
      </p>
    </div>
  )}
</Layout>